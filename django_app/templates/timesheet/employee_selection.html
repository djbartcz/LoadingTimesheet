{% extends "base.html" %}
{% load timesheet_tags %}

{% block content %}
<div class="min-h-screen px-3 sm:px-4 pt-12 sm:pt-14 pb-4 max-w-[600px] mx-auto">
    <!-- Logout Button - Mobile Friendly -->
    <div class="flex justify-end mb-2 sm:mb-3">
        <a href="{% url 'logout' %}" class="flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 py-1.5 sm:py-2 bg-white border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 transition-colors active:scale-[0.95] text-xs sm:text-sm font-medium shadow-sm">
            <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
            </svg>
            <span class="hidden sm:inline">Logout</span>
            <span class="sm:hidden">Odhl.</span>
        </a>
    </div>
    
    <!-- Header -->
    <div class="text-center py-4 sm:py-5 pb-5 sm:pb-6">
        <svg class="w-10 h-10 sm:w-12 sm:h-12 text-accent-primary mx-auto mb-2 sm:mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h1 class="font-grotesk text-xl sm:text-2xl font-bold mb-1">Evidence pracovní doby</h1>
        <p class="text-slate-600 text-sm sm:text-[15px]">Vyberte své jméno</p>
    </div>
    
    <!-- Admin Link - Only show for Admin group users -->
    {% if is_admin %}
    <a href="{% url 'admin_dashboard' %}" class="flex items-center gap-2 sm:gap-3 p-3 sm:p-3.5 mb-3 sm:mb-4 bg-gradient-to-r from-sky-50 to-blue-50 border border-blue-200 rounded-xl text-accent-primary font-semibold text-sm sm:text-[15px] hover:-translate-y-px transition-transform active:scale-[0.98]">
        <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
        </svg>
        <span class="flex-1">Admin přehled</span>
        <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
    </a>
    {% endif %}
    
    {% if error_message %}
    <div class="mb-3 sm:mb-4 p-3 sm:p-4 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-xs sm:text-sm">
        <strong>Upozornění:</strong> {{ error_message }}
    </div>
    {% endif %}
    
    <!-- Employee List -->
    <div class="flex flex-col gap-2">
        {% for employee in employees %}
            {% if employee.id in active_timers %}
                {% with active_timer=active_timers|get_item:employee.id %}
                <a href="{% url 'timer_page' employee.id %}" class="flex items-center gap-3 sm:gap-4 p-4 sm:p-[18px] bg-white border-2 rounded-xl transition-all cursor-pointer w-full text-left {% if active_timer.is_break %}border-accent-purple bg-gradient-to-r from-purple-50 {% elif active_timer.is_non_productive %}border-accent-orange bg-gradient-to-r from-orange-50 {% else %}border-accent-success bg-gradient-to-r from-green-50 {% endif %} hover:shadow-sm active:scale-[0.98]">
                    <svg class="w-6 h-6 sm:w-7 sm:h-7 flex-shrink-0 {% if active_timer.is_break %}text-accent-purple {% elif active_timer.is_non_productive %}text-accent-orange {% else %}text-accent-success {% endif %}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div class="flex-1 flex flex-col gap-0.5 min-w-0">
                        <span class="font-grotesk text-base sm:text-[17px] font-semibold truncate">{{ employee.name }}</span>
                        <div class="flex items-center gap-1.5 text-[11px] sm:text-xs font-medium {% if active_timer.is_break %}text-accent-purple {% elif active_timer.is_non_productive %}text-accent-orange {% else %}text-accent-success {% endif %}">
                            {% if active_timer.is_break %}
                            <svg class="w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            {% else %}
                            <svg class="w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            {% endif %}
                            <span class="truncate">{{ active_timer.project_name|default:active_timer.task }}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-1.5 px-2 sm:px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-semibold flex-shrink-0 {% if active_timer.is_break %}bg-purple-100 text-accent-purple {% elif active_timer.is_non_productive %}bg-orange-100 text-accent-orange {% else %}bg-green-100 text-accent-success {% endif %}">
                        <span class="w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full pulse-dot {% if active_timer.is_break %}bg-accent-purple {% elif active_timer.is_non_productive %}bg-accent-orange {% else %}bg-accent-success {% endif %}"></span>
                        <span class="hidden sm:inline">{% if active_timer.is_break %}Přestávka{% elif active_timer.is_non_productive %}Neprod.{% else %}Pracuje{% endif %}</span>
                        <span class="sm:hidden">{% if active_timer.is_break %}Př.{% elif active_timer.is_non_productive %}Nep.{% else %}Pr.{% endif %}</span>
                    </div>
                </a>
                {% endwith %}
            {% else %}
            <a href="{% url 'timer_page' employee.id %}" class="flex items-center gap-3 sm:gap-4 p-4 sm:p-[18px] bg-white border-2 border-slate-200 rounded-xl transition-all hover:border-accent-primary cursor-pointer w-full text-left active:scale-[0.98]">
                <svg class="w-6 h-6 sm:w-7 sm:h-7 flex-shrink-0 text-accent-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <div class="flex-1 flex flex-col gap-0.5 min-w-0">
                    <span class="font-grotesk text-base sm:text-[17px] font-semibold truncate">{{ employee.name }}</span>
                </div>
                <svg class="w-5 h-5 sm:w-6 sm:h-6 text-slate-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
            {% endif %}
        {% empty %}
        <div class="text-center py-8 text-slate-500 text-sm sm:text-base">Žádní zaměstnanci nenalezeni</div>
        {% endfor %}
    </div>
</div>
{% endblock %}

